<template>
  <div id="map"></div>
</template>
<script setup>
import { onMounted } from "vue";
let map;

onMounted(() => {
  initMap();
});
const initMap = () => {
  map = new window.T.Map("map", {
    center: new window.T.LngLat(106.59814621, 26.63713003),
    zoom: 9,
  });
  // eslint-disable-next-line no-undef
  map.setMapType(TMAP_HYBRID_MAP);
  gg();
};
const gg = () => {
  const str =
    "((106.59814621,26.63713003),(106.59814603,26.63713002),(106.59814617,26.63712908),(106.59814646,26.63712981),(106.59814632,26.63712941),(106.59814642,26.63712978),(106.59814632,26.63712949),(106.59814613,26.63712887),(106.5981462,26.63712909),(106.5981462,26.63712906),(106.59814732,26.63712884),(106.598164,26.63712713),(106.59819942,26.63712332),(106.59824087,26.63711639),(106.59828781,26.63710706),(106.59832739,26.63710098),(106.59836788,26.63709123),(106.59841005,26.6370783),(106.59844666,26.6370662),(106.59848311,26.63705608),(106.59852296,26.63704733),(106.59856746,26.6370423),(106.5986065,26.63704606),(106.598639,26.6370593),(106.59866725,26.63708217),(106.59869427,26.63711006),(106.59871984,26.63713587),(106.5987455,26.63716126),(106.59876362,26.63719218),(106.59878723,26.63721708),(106.59881891,26.63723747),(106.59885091,26.63725991),(106.59888275,26.63728265),(106.59891724,26.6373047),(106.59894487,26.63732483),(106.59894272,26.63733988),(106.59893913,26.63734814),(106.59892901,26.63737107),(106.59891266,26.63740159),(106.59889307,26.63743218),(106.59887866,26.63745701),(106.59886108,26.63748438),(106.5988391,26.63750763),(106.59882188,26.63753313),(106.59880328,26.63756004),(106.59878507,26.63758626),(106.59876958,26.63761001),(106.59875662,26.63762981),(106.5987466,26.63764869),(106.59873369,26.63766853),(106.59871459,26.63766971),(106.59868993,26.6376784),(106.59866257,26.63767762),(106.59863866,26.63767021),(106.59861486,26.63766204),(106.59858894,26.63765023),(106.59856447,26.63763237),(106.59854499,26.63761537),(106.5985248,26.6376022),(106.59850217,26.63759226),(106.59847627,26.63758022),(106.59845086,26.63756956),(106.59842706,26.63755691),(106.59840339,26.63754475),(106.59837987,26.63753339),(106.59835674,26.63752148),(106.59833373,26.63750808),(106.59831191,26.63749273),(106.59829078,26.63747547),(106.59827516,26.63745859),(106.59826175,26.63744139),(106.59825166,26.63742384),(106.59824665,26.63740104),(106.59824744,26.63737578),(106.59824625,26.63734858),(106.59823929,26.63732363),(106.59823354,26.6372995),(106.5982262,26.63727736),(106.59821801,26.63725619),(106.59820824,26.637237),(106.59819582,26.63721698),(106.59818783,26.63720023),(106.5981756,26.637187),(106.59815622,26.63716952),(106.59813923,26.63714976),(106.59813406,26.6371368),(106.59813579,26.63714069),(106.59813618,26.63714204),(106.59813635,26.63714227),(106.59813635,26.63714227),(106.59813635,26.63714227),(106.59813635,26.63714227),(106.59813635,26.63714227),(106.59813635,26.63714228),(106.59813635,26.63714228),(106.59813635,26.63714228),(106.59813635,26.63714228),(106.59813635,26.63714228),(106.59813635,26.63714226),(106.59814621,26.63713001))";
  const list = [{ id: 1 }, { id: 2 }];
  list.forEach((item) => {
    item.polygon = str;
  });
  for (let i = 0; i < list.length; i++) {
    const str = list[i].polygon;
    const noParens = str.replace(/\(/g, "").replace(/\)/g, "");
    const polygon = [];
    const numbers = noParens.split(",");
    while (numbers.length > 0) {
      polygon.push(numbers.splice(0, 2));
    }
    list[i].polygon = polygon;
  }
  draw(list);
};
const draw = (points) => {
  console.log(points, "points");
  const style = {
    color: "#4096FF",
    weight: 5,
    opacity: 1,
    lineStyle: "solid", // 实线;dashed虚线
    fillColor: "#4096FF",
    fillOpacity: 1, // 透明度
  };

  for (let i = 0; i < points.length; i++) {
    const landBoundaryLine = [];
    for (let j = 0; j < points[i].polygon.length; j++) {
      const point = new window.T.LngLat(
        points[i].polygon[j][0],
        points[i].polygon[j][1]
      );
      landBoundaryLine.push(point);
    }
    const poly = new window.T.Polygon(landBoundaryLine, style);
    map.addOverLay(poly);
  }
  // this.cityBoundaryLine = new window.T.Polygon(landBoundaryLine, style);
  // this.map.addOverLay(new window.T.Polygon(landBoundaryLine, style));
};
</script>
<style lang="scss" scoped>
#map {
  width: 100vw;
  height: 100vh;
}
</style>
